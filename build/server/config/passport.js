'use strict';

var LocalStrategy = require('passport-local').Strategy;

module.exports = function (passport, model) {
  passport.serializeUser(function (user, done) {
    done(null, user._id);
  });

  passport.deserializeUser(function (username, done) {
    model.find({ username: username }, function (err, user) {
      done(err, user);
    });
  });

  passport.use('localLogin', new LocalStrategy(
  // {
  //
  // },
  function (username, password, done) {
    model.findOne({ username: username }, function (err, user) {
      if (err) return done(err);
      if (!user) return done(null, false, { message: 'Wrong username' });
      if (!user.validPassword(password)) return done(null, false, { message: 'Bad Password' });
      return done(null, user);
    });
  }));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci9jb25maWcvcGFzc3BvcnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJLGdCQUFnQixRQUFRLGdCQUFSLEVBQTBCLFFBQTFCOztBQUVwQixPQUFPLE9BQVAsR0FBaUIsVUFBQyxRQUFELEVBQVcsS0FBWCxFQUFxQjtBQUNsQyxXQUFTLGFBQVQsQ0FBdUIsVUFBQyxJQUFELEVBQU8sSUFBUCxFQUFnQjtBQUNyQyxTQUFLLElBQUwsRUFBVyxLQUFLLEdBQUwsQ0FBWCxDQURxQztHQUFoQixDQUF2QixDQURrQzs7QUFLbEMsV0FBUyxlQUFULENBQXlCLFVBQUMsUUFBRCxFQUFXLElBQVgsRUFBb0I7QUFDM0MsVUFBTSxJQUFOLENBQVcsRUFBQyxVQUFVLFFBQVYsRUFBWixFQUFpQyxVQUFDLEdBQUQsRUFBTSxJQUFOLEVBQWU7QUFDOUMsV0FBSyxHQUFMLEVBQVUsSUFBVixFQUQ4QztLQUFmLENBQWpDLENBRDJDO0dBQXBCLENBQXpCLENBTGtDOztBQVdsQyxXQUFTLEdBQVQsQ0FBYyxZQUFkLEVBQTRCLElBQUksYUFBSjs7OztBQUk1QixZQUFDLFFBQUQsRUFBVyxRQUFYLEVBQXFCLElBQXJCLEVBQThCO0FBQzVCLFVBQU0sT0FBTixDQUFjLEVBQUMsVUFBVSxRQUFWLEVBQWYsRUFBb0MsVUFBQyxHQUFELEVBQU0sSUFBTixFQUFlO0FBQ2pELFVBQUcsR0FBSCxFQUNFLE9BQU8sS0FBSyxHQUFMLENBQVAsQ0FERjtBQUVBLFVBQUcsQ0FBQyxJQUFELEVBQ0QsT0FBTyxLQUFLLElBQUwsRUFBVyxLQUFYLEVBQWtCLEVBQUMseUJBQUQsRUFBbEIsQ0FBUCxDQURGO0FBRUEsVUFBRyxDQUFDLEtBQUssYUFBTCxDQUFtQixRQUFuQixDQUFELEVBQ0QsT0FBTyxLQUFLLElBQUwsRUFBVyxLQUFYLEVBQWtCLEVBQUMsdUJBQUQsRUFBbEIsQ0FBUCxDQURGO0FBRUEsYUFBTyxLQUFLLElBQUwsRUFBVyxJQUFYLENBQVAsQ0FQaUQ7S0FBZixDQUFwQyxDQUQ0QjtHQUE5QixDQUpBLEVBWGtDO0NBQXJCIiwiZmlsZSI6InNlcnZlci9jb25maWcvcGFzc3BvcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgTG9jYWxTdHJhdGVneSA9IHJlcXVpcmUoJ3Bhc3Nwb3J0LWxvY2FsJykuU3RyYXRlZ3lcblxubW9kdWxlLmV4cG9ydHMgPSAocGFzc3BvcnQsIG1vZGVsKSA9PiB7XG4gICAgcGFzc3BvcnQuc2VyaWFsaXplVXNlcigodXNlciwgZG9uZSkgPT4ge1xuICAgICAgZG9uZShudWxsLCB1c2VyLl9pZClcbiAgICB9KVxuXG4gICAgcGFzc3BvcnQuZGVzZXJpYWxpemVVc2VyKCh1c2VybmFtZSwgZG9uZSkgPT4ge1xuICAgICAgbW9kZWwuZmluZCh7dXNlcm5hbWU6IHVzZXJuYW1lfSwgKGVyciwgdXNlcikgPT4ge1xuICAgICAgICBkb25lKGVyciwgdXNlcilcbiAgICAgIH0pXG4gICAgfSlcblxuICAgIHBhc3Nwb3J0LnVzZSggJ2xvY2FsTG9naW4nLCBuZXcgTG9jYWxTdHJhdGVneShcbiAgICAgIC8vIHtcbiAgICAgIC8vXG4gICAgICAvLyB9LFxuICAgICh1c2VybmFtZSwgcGFzc3dvcmQsIGRvbmUpID0+IHtcbiAgICAgIG1vZGVsLmZpbmRPbmUoe3VzZXJuYW1lOiB1c2VybmFtZX0sIChlcnIsIHVzZXIpID0+IHtcbiAgICAgICAgaWYoZXJyKVxuICAgICAgICAgIHJldHVybiBkb25lKGVycilcbiAgICAgICAgaWYoIXVzZXIpXG4gICAgICAgICAgcmV0dXJuIGRvbmUobnVsbCwgZmFsc2UsIHttZXNzYWdlOiBgV3JvbmcgdXNlcm5hbWVgfSlcbiAgICAgICAgaWYoIXVzZXIudmFsaWRQYXNzd29yZChwYXNzd29yZCkpXG4gICAgICAgICAgcmV0dXJuIGRvbmUobnVsbCwgZmFsc2UsIHttZXNzYWdlOiBgQmFkIFBhc3N3b3JkYH0pXG4gICAgICAgIHJldHVybiBkb25lKG51bGwsIHVzZXIpXG4gICAgICB9KVxuICAgIH0pIClcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
